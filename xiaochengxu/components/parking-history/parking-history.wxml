<!-- components/parking-history/parking-history.wxml -->
<view class="history-container animate-fade-in">
    <!-- Header -->
    <view class="header">
        <view class="back-btn" bindtap="onBack">
            <text class="icon-back">â†</text>
        </view>
        <view class="title">åœè½¦è®°å½•</view>
        <view class="spacer"></view>
    </view>
    <!-- List -->
    <scroll-view scroll-y class="list-scroll">
        <block wx:if="{{formattedRecords.length === 0}}">
            <view class="empty-state">
                <view class="empty-icon-bg">
                    <text class="icon-calendar">ğŸ“…</text>
                </view>
                <text class="empty-text">æš‚æ— åœè½¦è®°å½•</text>
            </view>
        </block>
        <block wx:else>
            <view class="list-content">
                <block wx:for="{{formattedRecords}}" wx:key="id">
                    <view class="record-card">
                        <view class="card-top">
                            <view class="date-info">
                                <text class="icon-cal-sm">ğŸ“…</text>
                                <text>{{item.formattedDate}}</text>
                            </view>
                            <view class="cost-info">
                                <view class="cycle-badge">{{item.costCycleCount}}ä¸ªå‘¨æœŸ</view>
                                <view class="price-badge">
                                    <text class="currency">Â¥</text>
                                    {{item.totalCost || 0}}
                                </view>
                            </view>
                        </view>
                        <view class="location-row">
                            <view class="pin-icon-bg">
                                <text class="icon-pin">ğŸ“</text>
                            </view>
                            <view class="location-text">
                                <view class="location-name">{{item.locationName || "æœªè®°å½•åœ°ç‚¹"}}</view>
                                <view class="location-sub" wx:if="{{item.locationName}}">
                                    å·²å­˜æ¡£ä½ç½®ä¿¡æ¯
                                </view>
                                <view class="location-sub italic" wx:else>æ— è¯¦ç»†ä½ç½®æè¿°</view>
                            </view>
                        </view>
                        <view class="card-bottom">
                            <view class="duration-label">
                                <text class="icon-clock">ğŸ•’</text>
                                åœè½¦æ—¶é•¿
                            </view>
                            <view class="duration-value-group">
                                <text class="unit-cost" wx:if="{{item.cycleCost}}">
                                    (Â¥{{item.cycleCost}}/å‘¨æœŸ)
                                </text>
                                <text class="duration-val">{{item.formattedDuration}}</text>
                            </view>
                        </view>
                    </view>
                </block>
            </view>
        </block>
    </scroll-view>
    <!-- Footer -->
    <view class="footer" wx:if="{{formattedRecords.length > 0}}">
        <view class="clear-btn" bindtap="onClear">
            <text class="icon-trash">ğŸ—‘ï¸</text>
            æ¸…ç©ºå†å²è®°å½•
        </view>
    </view>
</view>